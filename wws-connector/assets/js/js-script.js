function get_all_sf_cat_ids(){msg_block=get_process_block("clock_block_import_category"),my_admin_notices_append("updated","Category(s) Import Started..",msg_block),window.stop_clock="no",timer_clock1("clock_block_import_category"),jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"getsfTotalCategories"},beforeSend:function(){window.formSubmitting=!1,my_admin_notices_append("updated","Product(s) Import Started..",msg_block),jQuery("#error_response").remove(),jQuery("#wwsimportproduct_id").addClass("is-active")},success:function(a){var b=jQuery.parseJSON(a);total_count=b.total_count,window.formSubmitting=!0,wwsimportCategory(total_count,total_count,1,0,0,0,0)},error:function(a){my_admin_notices_append("error","Error",a.responseText)},complete:function(){window.formSubmitting=!1,wwsimportCategory(0,0,1,0,0,0,0)}})}function get_checked_cat_ids(){return"no"==window.stop_clock&&!confirm("Import/Export going on.Are you sure you want to perform this action.?")||(window.cat_item_ids=new Array,jQuery("input[name='mergecategory[]']:checkbox").each(function(){1==jQuery(this).prop("checked")&&(item_id=jQuery(this).val(),window.cat_item_ids.push(item_id))}),msg_block=get_process_block("clock_block_export_category"),my_admin_notices_append("updated","Category(s) Export Started..",msg_block),window.stop_clock="no",timer_clock1("clock_block_export_category"),void(window.cat_item_ids.length>0&&wwsexportCategory(window.cat_item_ids.length,window.cat_item_ids.length,1,1,0,0,0)))}function check_other_clock(){return"no"==window.stop_clock&&!confirm("Import/Export going on.Are you sure you want to perform this action.?")}function get_woo_category_ids(){window.cat_item_ids=new Array,jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"getAllCategoryIds"},beforeSend:function(){},success:function(a){for(var b=jQuery.parseJSON(a),c=0;c<b.length;c++)item_id=b[c],window.cat_item_ids.push(item_id);wwsexportCategory(window.cat_item_ids.length,window.cat_item_ids.length,1,1,0,0,0)},error:function(a){my_admin_notices_append("error","Error",a.responseText)},complete:function(){window.stop_clock="yes",jQuery("#syncronizeproduct_id").removeClass("is-active")}})}function get_woo_product_ids(){window.item_ids=new Array,jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"getAllProductsIds"},beforeSend:function(){},success:function(a){for(var b=jQuery.parseJSON(a),c=0;c<b.length;c++)item_id=b[c],window.item_ids.push(item_id);wwsexportproduct(window.item_ids.length,window.item_ids.length,1,1,0,0,0)},error:function(a){my_admin_notices_append("error","Error",a.responseText)},complete:function(){jQuery("#syncronizeproduct_id").removeClass("is-active")}})}function get_process_block(a){return msg_block='<span id="wpsf_notice_block">',msg_block+="<br>",msg_block+='<span id="completed_b">0</span>% completed',msg_block+="<br>",msg_block+='<span id="current_option_going">Fetching total records...</span>',msg_block+="<hr>",msg_block+='Time Elapsed: <span id="'+a+'">00:00:00</span>',msg_block+="<br>",msg_block+='<span id="wpsf_end_notice"></span>',msg_block+="</span>",msg_block}function get_total(){window.stop_clock="no",timer_clock1("clock_block3"),jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"getsfTotalProducts"},beforeSend:function(){window.formSubmitting=!1,msg_block=get_process_block("clock_block3"),my_admin_notices_append("updated","Product(s) Import Started..",msg_block),jQuery("#wwsimportproduct_id").addClass("is-active")},success:function(a){var b=jQuery.parseJSON(a);total_count=b.total_count,window.formSubmitting=!0,import_products_batch(total_count,total_count,20,0,0,0,0)},error:function(a){my_admin_notices_append("error","Error",a.responseText)},complete:function(){window.formSubmitting=!1,import_products_batch(0,0,20,0,0,0,0)}})}function wwsexportproduct(a,b,c,d,e,f,g){operation_block='<span id="current_option_going"><b id="b_added">'+g+' </b> added / <b id="b_updated">'+f+'</b>  updated of <b id="b_total_records">'+a+"</b> records</span>",jQuery("#current_option_going").html(operation_block),window.item_ids.length>0?(window.formSubmitting=!1,e+=1,product_id=window.item_ids[0],wp_ajax=jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"exportProduct",product_id:product_id},beforeSend:function(){jQuery("#wpsf_notice_block li").length>5&&jQuery("#wpsf_notice_block li").first().slideUp("slow"),jQuery("#wwsimportproduct_id").addClass("is-active")},success:function(h){try{var i=jQuery.parseJSON(h);i.total&&(product_id=window.item_ids[0],i.updated?jQuery("#add_sf_sync_time_"+product_id).html(i.syncc_time):i.added&&(jQuery("#add_sf_product_id_"+product_id).html(i.sf_product_id),jQuery("#add_sf_sync_time_"+product_id).html(i.syncc_time)),b-=c,d=e*c,percentage=d/a*100,percentage>100&&(percentage=100),jQuery("#completed_b").text(parseInt(percentage)),f=i.updated+parseInt(jQuery("#b_updated").text()),g=i.added+parseInt(jQuery("#b_added").text()),window.item_ids.shift(),wwsexportproduct(a,b,c,d,e,f,g))}catch(a){window.formSubmitting=!0,jQuery("#wpsf_end_notice").append("<mark class='incomplete tips' style='background-color:red;color:white;'>Error Occured</mark>"),window.stop_clock="yes",my_admin_notices_append("error","Error",h)}},error:function(a){window.formSubmitting=!0,jQuery("#wpsf_end_notice").append("<mark class='incomplete tips' style='background-color:red;color:white;'>Error Occured</mark>"),window.stop_clock="yes",my_admin_notices_append("error","Error",a.responseText)},complete:function(){jQuery("#wwsimportproduct_id").removeClass("is-active")}})):(window.formSubmitting=!0,jQuery("#wpsf_end_notice").append("<mark class='completed tips'>Completed</mark>"),window.stop_clock="yes","yes"==window.sync_all&&(window.sync_all="no",jQuery("#wwsimportproduct_button").trigger("click")))}function wwsimportCategory(a,b,c,d,e,f,g){if(operation_block='<span id="current_option_going"><b id="b_added">'+g+' </b> added / <b id="b_updated">'+f+'</b>  updated of <b id="b_total_records">'+a+"</b> records</span>",jQuery("#current_option_going").html(operation_block),b>0){window.formSubmitting=!1,e+=1,total_completed=0;var h={action:"importCategory",limit:c,offset:d};jQuery("#sfwp_limit_import_ch").is(":checked")&&jQuery.isNumeric(jQuery("#sfwp_product_limit").val())&&(h.limit=jQuery("#sfwp_product_limit").val()),jQuery.ajax({type:"POST",url:ajaxurl,data:h,beforeSend:function(){window.formSubmitting=!1,jQuery("#wwsimportCategory_id").addClass("is-active")},success:function(h){obj=jQuery.parseJSON(h),b-=c,d=e*c,percentage=d/a*100,percentage>100&&(percentage=100),jQuery("#completed_b").text(parseInt(percentage)),f=obj.updated+parseInt(jQuery("#b_updated").text()),g=obj.added+parseInt(jQuery("#b_added").text()),wwsimportCategory(a,b,c,d,e,f,g)},error:function(a){my_admin_notices_append("error","Error",a.responseText)},complete:function(){jQuery("#wwsimportCategory_id").removeClass("is-active")}})}else window.formSubmitting=!0,jQuery("#wwsimportproduct_id").removeClass("is-active"),jQuery("#wpsf_end_notice").append("<mark class='completed tips'>Completed</mark>"),window.stop_clock="yes"}function import_products_batch(a,b,c,d,e,f,g){if(operation_block='<span id="current_option_going"><b id="b_added">'+g+' </b> added / <b id="b_updated">'+f+'</b>  updated of <b id="b_total_records">'+a+"</b> records</span>",jQuery("#current_option_going").html(operation_block),b>0){window.formSubmitting=!1,e+=1,total_completed=0;var h={action:"importProduct",limit:c,offset:d};jQuery("#sfwp_limit_import_ch").is(":checked")&&jQuery.isNumeric(jQuery("#sfwp_product_limit").val())&&(h.limit=jQuery("#sfwp_product_limit").val()),jQuery.ajax({type:"POST",url:ajaxurl,data:h,beforeSend:function(){window.formSubmitting=!1},success:function(h){obj=jQuery.parseJSON(h),b-=c,d=e*c,percentage=d/a*100,percentage>100&&(percentage=100),jQuery("#completed_b").text(parseInt(percentage)),f=obj.updated+parseInt(jQuery("#b_updated").text()),g=obj.added+parseInt(jQuery("#b_added").text()),import_products_batch(a,b,c,d,e,f,g)},error:function(a){my_admin_notices_append("error","Error",a.responseText)},complete:function(){}})}else window.formSubmitting=!0,jQuery("#wwsimportproduct_id").removeClass("is-active"),jQuery("#wpsf_end_notice").append("<mark class='completed tips'>Completed</mark>"),window.stop_clock="yes"}function timer_clock1(a){function d(){if(b+=1,"yes"==window.stop_clock)return void clearInterval(c);var d=b%60,e=Math.floor(b/60),f=Math.floor(e/60);e%=60,f%=60,f<10&&(f="0"+f),e<10&&(e="0"+e),d<10&&(d="0"+d),jQuery("#"+a).html(f+":"+e+":"+d)}var b=0,c=setInterval(d,1e3)}function wwsexportCategory(a,b,c,d,e,f,g){operation_block='<span id="current_option_going"><b id="b_added">'+g+' </b> added / <b id="b_updated">'+f+'</b>  updated of <b id="b_total_records">'+a+"</b> records</span>",jQuery("#current_option_going").html(operation_block),window.cat_item_ids.length>0?(window.formSubmitting=!1,e+=1,cat_id=window.cat_item_ids[0],data={action:"exportCategory",cat_id:cat_id},jQuery.ajax({type:"POST",url:ajaxurl,data:data,beforeSend:function(){jQuery("#wwsexportCategory_id").addClass("is-active")},success:function(h){try{var i=jQuery.parseJSON(h);i.total&&(cat_id=window.cat_item_ids[0],i.updated?jQuery("#add_sf_sync_time_"+cat_id).html(i.syncc_time):i.added&&(jQuery("#add_sf_cat_id_"+cat_id).html(i.sf_category_id),jQuery("#add_sf_sync_time_"+cat_id).html(i.syncc_time)),b-=c,d=e*c,percentage=d/a*100,percentage>100&&(percentage=100),jQuery("#completed_b").text(parseInt(percentage)),f=i.updated+parseInt(jQuery("#b_updated").text()),g=i.added+parseInt(jQuery("#b_added").text()),window.cat_item_ids.shift(),wwsexportCategory(a,b,c,d,e,f,g))}catch(a){jQuery("#wpsf_end_notice").append("<mark class='incomplete tips' style='background-color:red;color:white;'>Error Occured</mark>"),window.stop_clock="yes",my_admin_notices_append("error","Error",h)}},error:function(a){my_admin_notices_append("error","Error",a.responseText)},complete:function(){}})):(window.formSubmitting=!0,jQuery("#wwsexportCategory_id").removeClass("is-active"),jQuery("#wpsf_end_notice").append("<mark class='completed tips'>Completed</mark>"),window.stop_clock="yes","yes"==window.sync_all&&(window.sync_all="no",jQuery("#wwsimportCategory_button").trigger("click")))}function my_admin_notices_append(a,b,c){var d='<div class="'+a+' notice is-dismissible" id="error_response"> <p> <strong>'+b+" </strong> "+c+'</p><button class="notice-dismiss" type="button"><span class="screen-reader-text">Dismiss this notice.</span></button></div>';jQuery("#my_wrap").prepend(d)}jQuery(function(a){window.stop_clock="yes",window.formSubmitting=!0,window.onload=function(){window.addEventListener("beforeunload",function(a){if(!window.formSubmitting){var b="It looks like you have been syncronizing. If you leave before completion, some of the data might not be saved.";return(a||window.event).returnValue=b,b}})},window.item_ids=new Array,window.sync_all="",a("#syncronizeproduct_button").on("click",function(){"no"==window.stop_clock?confirm("Are you sure you want to perform this action")&&(window.sync_all="yes",a("#wwsexportproduct_button").trigger("click")):(window.sync_all="yes",a("#wwsexportproduct_button").trigger("click"))}),a("#wwsexportproduct_button").on("click",function(){"no"==window.stop_clock?confirm("Are you sure you want to perform this action")&&(jQuery("#error_response").remove(),msg_block=get_process_block("clock_block2"),my_admin_notices_append("updated","Product(s) Export Started..",msg_block),window.stop_clock="no",timer_clock1("clock_block2"),get_woo_product_ids()):(jQuery("#error_response").remove(),msg_block=get_process_block("clock_block2"),my_admin_notices_append("updated","Product(s) Export Started..",msg_block),window.stop_clock="no",timer_clock1("clock_block2"),get_woo_product_ids())}),a("#sfwp_limit_import_ch").on("click",function(){a(this).is(":checked")?a("#sfwp_product_limit").prop("disabled",!1):a("#sfwp_product_limit").prop("disabled",!0)}),a("#wwsimportproduct_button").on("click",function(a){"no"==window.stop_clock?confirm("Are you sure you want to perform this action. There is already import/export going on..")&&get_total():get_total()}),a("#a_import_option").on("click",function(){a("#con_import_options").slideToggle()}),a(".target").click(function(){a.post(ajax_object.ajaxurl,{action:"ajax_action",post_id:a(this).find("input.post_id").attr("value")},function(a){alert(a)})}),a(document).on("click",".notice-dismiss",function(){"no"==window.stop_clock?confirm("Are you sure you want to dismiss this block. Import/export is going on..")&&a(this).parent().remove():a(this).parent().remove()}),a(document).on("click","#doaction,#doaction2",function(b){var c=a("#bulk-action-selector-top").val(),d=a("#bulk-action-selector-bottom").val();if("doaction"==a(this).prop("id")){if("-1"==c)return b.preventDefault(),!1;"exportCategory"==c&&(b.preventDefault(),get_checked_cat_ids()),"exportProduct"==c&&(b.preventDefault(),"no"==window.stop_clock?confirm("Are you sure you want to perform this action. There is already import/export going on..")&&(window.item_ids=new Array,a("input[name='mergedproduct[]']:checkbox").each(function(){1==a(this).prop("checked")&&(item_id=a(this).val(),window.item_ids.push(item_id))}),window.item_ids.length>0&&(jQuery("#error_response").remove(),msg_block=get_process_block("clock_block1"),my_admin_notices_append("updated","Product(s) Export Started..",msg_block),window.stop_clock="no",timer_clock1("clock_block1"),window.formSubmitting=!1,wwsexportproduct(window.item_ids.length,window.item_ids.length,1,1,0,0,0))):(window.item_ids=new Array,a("input[name='mergedproduct[]']:checkbox").each(function(){1==a(this).prop("checked")&&(item_id=a(this).val(),window.item_ids.push(item_id))}),window.item_ids.length>0&&(jQuery("#error_response").remove(),msg_block=get_process_block("clock_block1"),my_admin_notices_append("updated","Product(s) Export Started..",msg_block),window.stop_clock="no",timer_clock1("clock_block1"),window.formSubmitting=!1,wwsexportproduct(window.item_ids.length,window.item_ids.length,1,1,0,0,0))))}else"doaction2"==a(this).prop("id")&&("-1"==d&&b.preventDefault(),"exportCategory"==d&&(b.preventDefault(),get_checked_cat_ids()),"exportProduct"==d&&(b.preventDefault(),"no"==window.stop_clock?confirm("Are you sure you want to perform this action. There is already import/export going on..")&&(window.item_ids=new Array,a("input[name='mergedproduct[]']:checkbox").each(function(){1==a(this).prop("checked")&&(item_id=a(this).val(),window.item_ids.push(item_id))}),window.item_ids.length>0&&(jQuery("#error_response").remove(),msg_block=get_process_block("clock_block1"),my_admin_notices_append("updated","Product(s) Export Started..",msg_block),window.stop_clock="no",timer_clock1("clock_block1"),window.formSubmitting=!1,wwsexportproduct(window.item_ids.length,window.item_ids.length,1,1,0,0,0))):(window.item_ids=new Array,a("input[name='mergedproduct[]']:checkbox").each(function(){1==a(this).prop("checked")&&(item_id=a(this).val(),window.item_ids.push(item_id))}),window.item_ids.length>0&&(jQuery("#error_response").remove(),msg_block=get_process_block("clock_block1"),my_admin_notices_append("updated","Product(s) Export Started..",msg_block),window.stop_clock="no",timer_clock1("clock_block1"),window.formSubmitting=!1,wwsexportproduct(window.item_ids.length,window.item_ids.length,1,1,0,0,0)))))}),a("#wwsexportCategory_button").on("click",function(){return!!check_other_clock()||(msg_block=get_process_block("clock_block_export_category"),my_admin_notices_append("updated","Category(s) Export Started..",msg_block),window.stop_clock="no",timer_clock1("clock_block_export_category"),void get_woo_category_ids())}),a("#wwsimportCategory_button").on("click",function(){return!!check_other_clock()||void get_all_sf_cat_ids()}),a("#syncronizeCategory_button").on("click",function(){return!!check_other_clock()||(window.sync_all="yes",void a("#wwsexportCategory_button").trigger("click"))})});